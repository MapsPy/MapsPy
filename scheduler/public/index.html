<!DOCTYPE html>
<html>
  <head>
    <link href="/static/css/style.css" rel="stylesheet">
    <script src="http://code.jquery.com/jquery-2.0.3.min.js"></script>
    <script type="text/javascript">
      $(document).ready(function() 
      {
        //get all process nodes
        $.ajax(
        {
          url:"/process_node",
          datatype: "text",
          success: function(data) 
          {
            var $table = $("#process_node_table");
            var nodes = $.parseJSON(data);
            var $tr = $("<tr id='data_entry'>");
            nodes.forEach( function(item) 
            {
              $tr.append( $("<td>").text(item.ComputerName));
              $tr.append( $("<td>").text(item.NumThreads));
              $tr.append( $("<td>").text(item.Status));
              $tr.append( $("<td>").text(item.Heartbeat));
            })
            $table.append( $tr);
          }
        });
        //get all jobs
        $.ajax(
        {
          url:"/job",
          datatype: "text",
          success: function(data) 
          {
            var $table = $("#job_table");
            var nodes = $.parseJSON(data);
            var $tr = $("<tr id='data_entry'>");
            nodes.forEach( function(item) 
            {
              $tr.append( $("<td>").text(item.Id));
              $tr.append( $("<td>").text(item.DataPath));
            })
            $table.append( $tr);
          }
        });

/*
        $.get( "/process_node", function( data ) {
          var $table = $("#process_node_table");
          $.each(data, function(idx, item){
            var $tr = $("<tr id='data_entry'>");
            $.each(item, function(key, col){
              $tr.append( $("<td>").text(col))
            })
          $table.append( $tr);
          })
        } , "json" );
  
        //get all jobs
        $.get( "/job", function( data ) {
          var $table = $("#job_table");
          $.each(data, function(idx, item){
            var $tr = $("<tr id='data_entry'>");
            $.each(item, function(key, col){
              $tr.append( $("<td>").text(col))
            })
          $table.append( $tr);
          })
        } , "json" );
*/
      $('.header').click(function(){
        $(this).toggleClass('expand').nextUntil('tr.header').slideToggle(100);
      });

/*
      setInterval(function(){
        $.ajax({ url: "/process_node", success: function(data){
          var $table = $("#process_node_table");
          $table.empty();
          $.each(data, function(idx, item){
            var $tr = $("<tr id='data_entry'>");
            $.each(item, function(key, col){
              $tr.append( $("<td>").text(col))
            })
          $table.append( $tr);
          })
          
          }, dataType: "json"});
      }, 3000);
*/
/*
         $("#generate-string").click(function(e) {
           $.post("/generator", {"length": $("input[name='length']").val()})
            .done(function(string) {
               $("#the-string").show();
               $("#the-string input").val(string);
            });
           e.preventDefault();
         });

         $("#replace-string").click(function(e) {
           $.ajax({
              type: "PUT",
              url: "/generator",
              data: {"another_string": $("#the-string").val()}
           })
           .done(function() {
              alert("Replaced!");
           });
           e.preventDefault();
         });

         $("#delete-string").click(function(e) {
           $.ajax({
              type: "DELETE",
              url: "/generator"
           })
           .done(function() {
              $("#the-string").hide();
           });
           e.preventDefault();
         });


*/
       });
     </script>
   </head>
   <body>
     <div id="process_nodes_div">
         <table id="process_node_table">
         <!--  <tr class="header expand"> <th> <span class="sign">  <td> Computer Name </td> <td> Number of Threads </td> <td> Status </td> <td> Heartbeat </td> </span>  </th> </tr> -->
           <tr class="header expand"> <th colsnap="4"> <span class="sign"> </snap> Computer Name  </th> </tr>
           
         </table>
     </div>
     <div id="jobs_div">
         <table id="job_table">
           <tr class="header expand"> <th colsnap="4"> <span class="sign"> </snap> Jobs  </th> </tr>
           
         </table>
     </div>
<!--
     <input type="text" value="8" name="length" />
     <button id="generate-string">Give it now!</button>
     <div id="the-string">
         <input type="text" />
         <button id="replace-string">Replace</button>
         <button id="delete-string">Delete it</button>
     </div>
-->
   </body>
</html>
